<!DOCTYPE html><html lang="zh-TW"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js · NingLab</title><meta name="description" content="從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js開始手刻之前，我們來快速認識Rails的運作以及架構吧 🥳直接進入主題 Go!
Rails 採用 MVC 架構，另外還有 R (Route)MVC 分別為 Model、View、Controller

我"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4P2R013PGL"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-4P2R013PGL')
</script><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.jpeg" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/ning.jpg" style="width:200px;"><h3 title=""><a href="/">NingLab</a></h3></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://twitter.com/ningchang_"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" rel="noopener" href="https://github.com/cacachang"><i class="fa fa-github"></i></a></li><li><a href="mailto:a24701770@gmail.com"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.instagram.com/web543_/"><i class="fa fa-instagram"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/cacachang/"><i class="fa fa-linkedin"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCwRiNPzYITZWaif23HTmHZQ"><i class="fa fa-youtube"></i></a></li></ul><div class="footer"><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首頁</a></li><li><a href="/archives">文章</a></li><li><a href="/categories">目錄</a></li><li><a href="/about">關於 Ning</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.jpeg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js</a></h3></div><div class="post-content"><h1 id="從0開始刻-淺談-Rails-的運作魔法-Day01-RMVC架構之為什麼要安裝node-js"><a href="#從0開始刻-淺談-Rails-的運作魔法-Day01-RMVC架構之為什麼要安裝node-js" class="headerlink" title="從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js"></a>從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js</h1><p>開始手刻之前，我們來快速認識Rails的運作以及架構吧 🥳<br>直接進入主題 Go!</p>
<p>Rails 採用 MVC 架構，另外還有 R (Route)<br>MVC 分別為 Model、View、Controller</p>
<p><img src="https://i.imgur.com/W0Ml2sq.jpg"></p>
<p>我們用生活中的例子來解說MVC會更好理解<br>到餐廳點餐時，會先看到菜單(View)<br>選好自己想吃的菜餚<br>會由廚師(Controller)依菜餚到食材庫(Model)挑選原料</p>
<p>挑好適合的原料(Model)後，廚師會開始料理(Controller)<br>料理完成就會送到你的眼前(View)</p>
<p>View 主要處理呈現的畫面，以 HTML 為架構<br>Controller 會跟 Model 拿取資料並運算，算完會回傳給 View 呈現<br>Model 負責跟資料庫對話，拿取原始資料並物件化</p>
<p>還有一個很重要的角色，是 Route !<br>Route 就很像路標，告訴你該何去何從 ➡➡➡</p>
<h3 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h3><p>Rails 的路徑表<br>當路徑被觸發時<br>Rails 會依照路徑及 REST 判斷要去找哪個 Controller 及 action<br>當我們用 resources 做路徑時，會做出8條路徑7個方法</p>
<p>👩‍🏫 實做小學堂</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rails檔案中的routes檔</span></span><br><span class="line">resources <span class="symbol">:restaurant</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 終端機下指令</span></span><br><span class="line">&gt; rails routes -c restaurant</span><br><span class="line"></span><br><span class="line"><span class="title class_">Prefix</span> <span class="title class_">Verb</span>   <span class="variable constant_">URI</span> <span class="title class_">Pattern</span>                     <span class="title class_">Controller</span><span class="comment">#Action</span></span><br><span class="line">    restaurants <span class="variable constant_">GET</span>    /restaurants(.<span class="symbol">:format</span>)          restaurants<span class="comment">#index</span></span><br><span class="line">                <span class="variable constant_">POST</span>   /restaurants(.<span class="symbol">:format</span>)          restaurants<span class="comment">#create</span></span><br><span class="line"> new_restaurant <span class="variable constant_">GET</span>    /restaurants/new(.<span class="symbol">:format</span>)      restaurants<span class="comment">#new</span></span><br><span class="line">edit_restaurant <span class="variable constant_">GET</span>    /restaurants/<span class="symbol">:id/edit</span>(.<span class="symbol">:format</span>) restaurants<span class="comment">#edit</span></span><br><span class="line">     restaurant <span class="variable constant_">GET</span>    /restaurants/<span class="symbol">:id</span>(.<span class="symbol">:format</span>)      restaurants<span class="comment">#show</span></span><br><span class="line">                <span class="variable constant_">PATCH</span>  /restaurants/<span class="symbol">:id</span>(.<span class="symbol">:format</span>)      restaurants<span class="comment">#update</span></span><br><span class="line">                <span class="variable constant_">PUT</span>    /restaurants/<span class="symbol">:id</span>(.<span class="symbol">:format</span>)      restaurants<span class="comment">#update</span></span><br><span class="line">                <span class="variable constant_">DELETE</span> /restaurants/<span class="symbol">:id</span>(.<span class="symbol">:format</span>)      restaurants<span class="comment">#destroy</span></span><br></pre></td></tr></table></figure>


<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><p>有寫過 Rails 的你<br>應該對於 erb 這個檔名不陌生<br>erb &#x3D; Embedded Ruby<br>可以在 HTML 中加入 Ruby 的語法</p>
<h4 id="View-helper"><a href="#View-helper" class="headerlink" title="View helper"></a>View helper</h4><p>舉凡 form_for、form_with、link_to 這些表單、連結方法<br>都是 view helper 的一種<br>當我們把 Ruby 寫進 HTML 中<br>程式碼會變得複雜又不直觀<br>Rails 的 app&#x2F;helper 可以幫助我們整理 View 裡面的程式碼<br>將簡單的運算、程式放到 helper 中<br>讓View更簡潔 </p>
<p><strong>💎 Rails developer 必知的CoC</strong><br>erb 檔所在的資料夾必須與 Controller 呼應<br>view 的檔案名稱需要對應到 Controller 的 action 名稱<br>當 Controller 運算完畢才知道要往哪邊送</p>
<p>以下圖為例<br>路徑對應的 Controller 為 article、action 為 show<br>我們就要在 view 資料夾下面建立 article 資料夾<br>article 的 show 方法會取找資料夾中的 show.html.erb</p>
<p><img src="https://i.imgur.com/wtM7ljI.png"></p>
<h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><p>接收需求、依照指令將任務辦妥是 Controller 的職責<br>就像是上述提到的廚師一樣<br>顧客點了哪些餐點、需要哪些原料<br>從 View 那邊接收到資訊後<br>會依需求去找 Model 要資料<br>要完就會開始進行運算</p>
<p>相較 View 與 Model<br>Controller 聽起來真的很辛苦呢！<br>不僅要會溝通、還要懂做事</p>
<h4 id="action"><a href="#action" class="headerlink" title="action"></a>action</h4><p>Controller 裡的方法<br>通常會由 routes 來指定要使用哪個方法<br>當路徑被觸發時<br>action 就會被執行</p>
<p><strong>💎Rails developer 必知的CoC</strong><br>Controller 都要用複數來命名<br>檔名是 snake_case<br>名稱是 camelCase</p>
<p>以 article 來看<br>檔名是 articles_controller.rb</p>
<p><img src="https://i.imgur.com/5gPqtxj.png"></p>
<p>不過檔案中的 Controller 是 ArticlesController</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ArticlesController</span> &lt; <span class="title class_ inherited__">ApplicationController</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>


<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><p>很多人常把 Model 跟資料庫 Database 搞混<br>不過他們是不一樣的東西！</p>
<p>把 Model 跟 Database 想像成郵局的窗口與倉庫<br>Model 會依照 Controller 提出的需求<br>跟 Database 要資料</p>
<p>Database 會把資料 table 傳給 Model<br>Model 會遵循 ORM 將這些資料物件化後給 Controller</p>
<ul>
<li>ORM 為物件關聯對映：無需使用 SQL 語法，用程式碼就能以物件化的方式操作資料表</li>
</ul>
<p><img src="https://i.imgur.com/iXhvW2V.jpg"></p>
<p>用剛剛舉的郵局例子來說<br>我們去郵局領過期信件時，會先跟窗口提出需求<br>窗口依我們需求去倉庫拿信件，蓋完章後再交給我們</p>
<p><strong>💎Rails developer 必知的CoC</strong><br>Model 的 class 名稱為大寫、單數<br>table 則是小寫、複數<br>檔名則是小寫、單數</p>
<table>
<thead>
<tr>
<th>檔名</th>
<th>Model</th>
<th>table</th>
</tr>
</thead>
<tbody><tr>
<td>menu</td>
<td>Menu</td>
<td>appetizers</td>
</tr>
<tr>
<td></td>
<td></td>
<td>dishes</td>
</tr>
<tr>
<td></td>
<td></td>
<td>desserts</td>
</tr>
</tbody></table>
<h3 id="ActiveRecord"><a href="#ActiveRecord" class="headerlink" title="ActiveRecord"></a>ActiveRecord</h3><p>是一種設計模式，將資料物件化<br>存入及存取都是以物件模式進行</p>
<p>ActiveRecord 在 Rails 中廣泛應用<br>以下簡短介紹一下各個功能</p>
<ul>
<li>ActiveRecord Migration :對資料庫欄位做新增、修改、刪除</li>
<li>ActiveRecord Validations :對即將寫入的資料做驗證</li>
<li>ActiveRecord Callbacks :物件在新增到刪除以及資料庫讀取的作業循環</li>
<li>ActiveRecord Associations :資料表與資料表之間的關係</li>
<li>ActiveRecord Query Interface :取得資料庫資料的語法</li>
</ul>
<p>詳細資料可再多參照 <a target="_blank" rel="noopener" href="https://guides.rubyonrails.org/index.html">Rails 官方網站</a></p>
<h3 id="Asset-Pipeline"><a href="#Asset-Pipeline" class="headerlink" title="Asset Pipeline"></a>Asset Pipeline</h3><p>JavaScript、CSS 等被稱為靜態檔案<br>瀏覽器從 public 資料夾中讀取靜態檔案，所以靜態檔案都要放在這個資料夾<br>不過 Asset Pipeline 中的 Tilt 會去解析檔名，解析後讓 Sprockets 去各個目錄中收集靜態檔案並打包，放到 public 資料夾中</p>
<p><img src="https://i.imgur.com/0r9y96F.jpg"></p>
<p>把Pipeline的功能整理一下：</p>
<ol>
<li>整合靜態檔案，減少瀏覽器的 request</li>
<li>改用 fingerprint，快速比對版本差異，減少對瀏覽器的 request</li>
<li>支援 CSS、coffeeScript 等語言，寫 css 跟 js 更方便</li>
</ol>
<h4 id="📌-題外話：Rails-的安裝之路既繁瑣又複雜"><a href="#📌-題外話：Rails-的安裝之路既繁瑣又複雜" class="headerlink" title="📌 題外話：Rails 的安裝之路既繁瑣又複雜"></a>📌 題外話：Rails 的安裝之路既繁瑣又複雜</h4><p>為什麼安裝 Rails 還要另外安裝 node.js 呢？</p>
<p>早期的 Rails 版本其實不用安裝<br>但後期引進了用 node.js 寫的 webpack 套件<br>會將所有的 js 檔案快速打包<br>所以我們就得安裝 node.js</p>
<p>不過 rails 7 有另外的打包方式<br>所以使用 rails 7 就不用裝囉</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2022-08-15</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Rebuild-Rails/" title="Rebuild Rails">Rebuild Rails </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://ninglab.com/從0開始刻-淺談-Rails-的運作魔法-Day01-RMVC架構之為什麼要安裝node-js/,NingLab,從0開始刻 淺談 Rails 的運作魔法 Day01 RMVC架構之為什麼要安裝node.js,;"></a></div></div><div><script src="https://utteranc.es/client.js" repo="cacachang/cacachang.github.io" issue-term="title" theme="github-light" crossorigin="anonymous" async></script></div><div><script type="text/javascript">document.write("<iframe scrolling='no' frameborder='0' sandbox='allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation' style='height: 212px; width: 100%;' src='https://button.like.co/in/embed/a24701770/button?referrer=" + encodeURIComponent(location.href.split("?")[0].split("#")[0]) + "'></iframe>");</script></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/%E5%BE%9E0%E9%96%8B%E5%A7%8B%E5%88%BB-%E6%B7%BA%E8%AB%87-Rails-%E7%9A%84%E9%81%8B%E4%BD%9C%E9%AD%94%E6%B3%95-Day02-Rack/" title="從0開始刻 淺談 Rails 的運作魔法 Day02 - Rack">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/JavaScript-this/" title="幫網頁施點魔法 - JavaScript this">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>